<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LAVA Safeco — Quote (Auto & Home)</title>

  <style>
    :root{
      --bg:#f6f8fb;
      --card:#ffffff;
      --accent:#0d6efd;
      --accent-dark:#0b5ed7;
      --muted:#6b7280;
      --shadow: 0 8px 24px rgba(11, 29, 66, 0.08);
      --radius:12px;
      --maxw:1100px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:#0f1724}
    /* Topbar */
    .topbar{
      position:fixed;left:0;right:0;top:0;height:64px;background:#fff;border-bottom:1px solid #eef2f7;
      display:flex;align-items:center;padding:0 20px;z-index:120;
      box-shadow: 0 2px 6px rgba(2,6,23,0.03);
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:10px;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700}
    .brand h1{font-size:16px;margin:0;color:var(--accent);letter-spacing:.2px}
    .top-actions{margin-left:auto;display:flex;gap:10px;align-items:center}
    .btn { font-weight:700; border:0; cursor:pointer; padding:8px 12px; border-radius:8px; }
    .btn-ghost { background:transparent; border:1px solid #eef2f7; color:#374151 }
    .btn-primary { background:var(--accent); color:#fff }
    .btn-accent-outline { background:transparent; border:2px solid var(--accent); color:var(--accent) }

    /* Layout */
    .page { max-width: var(--maxw); margin:92px auto 60px; padding:20px; }
    .card{background:var(--card);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow);margin-bottom:18px}
    .center { text-align:center }

    /* Product selection */
    .choose-card { display:flex; gap:18px; justify-content:center; align-items:stretch; padding:28px; }
    .choice{
      flex:1; border-radius:10px; padding:18px; background:#fff; border:1px solid #e9f0ff;
      display:flex; flex-direction:column; gap:12px; align-items:flex-start;
    }
    .choice h3{margin:0;color:var(--accent)}
    .choice p{margin:0;color:var(--muted); font-size:14px}

    /* Tabs area */
    .tabs { display:flex; gap:8px; flex-wrap:wrap; margin-left:6px; margin-top:6px }
    .tab-btn { padding:8px 12px; border-radius:8px; background:#f2f6ff; border:1px solid #e9f0ff; color:#0f1724; font-weight:700; cursor:pointer }
    .tab-btn.active { background:var(--accent); color:#fff; border-color:var(--accent) }

    /* Form area */
    .form-area { margin-top:12px }
    .section-title { font-weight:800; color:var(--accent); margin:6px 0 12px; font-size:16px }
    .placeholder { border-radius:8px; background:#fbfdff; border:1px dashed #e6eefc; padding:14px; color:var(--muted) }
    .placeholder small { display:block; margin-top:8px; color:#475569 }

    .nav-actions { display:flex; justify-content:space-between; align-items:center; margin-top:16px; gap:12px }
    .nav-left { display:flex; gap:8px }
    .muted { color:var(--muted); font-size:13px }
    .quote-result { border-radius:8px; border:1px dashed #e6eefc; padding:12px; background:#fbfdff; margin-top:12px }
    .summary-card { display:none; margin-top:12px }
    .small{font-size:13px}

    /* Responsive */
    @media (max-width:900px){
      .choose-card { flex-direction:column }
      .tabs { overflow:auto; -webkit-overflow-scrolling:touch }
      .topbar { padding:0 12px }
      .page { padding:12px;margin-top:84px }
    }
  </style>
</head>
<body>

  <header class="topbar">
    <div class="brand">
      <div class="logo">L</div>
      <div>
        <h1>LAVA Safeco</h1>
        <div class="muted small">Quote Builder (Auto & Home)</div>
      </div>
    </div>

    <div class="top-actions">
      <button id="backToDash" class="btn btn-ghost">← Dashboard</button>
    </div>
  </header>

  <main class="page">

    <!-- Product selection (initial) -->
    <section class="card" id="selectProductCard">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
        <div>
          <div class="section-title">Select Product Type</div>
          <div class="muted">Choose which quote you want to create. This selection will reveal the full form for the product.</div>
        </div>
        <div style="min-width:220px" class="center muted small">You can change later via the top-left back button.</div>
      </div>

      <div class="choose-card" style="margin-top:18px">
        <div class="choice" id="chooseAuto">
          <h3>Auto Quote</h3>
          <p>Policy Info, Drivers, Vehicles, Coverages, Discounts, Underwriting, Review, Billing, Issue.</p>
          <small class="muted">Click Start to fill an Auto quote.</small>
          <div style="margin-top:auto;width:100%"><button class="btn btn-primary" data-type="auto">Start Auto Quote</button></div>
        </div>

        <div class="choice" id="chooseHome">
          <h3>Home Quote</h3>
          <p>Applicant, Dwelling Info, Cost Guide, Underwriting, Coverage Selection, Summary, Order Reports, Billing, Issue.</p>
          <small class="muted">Click Start to fill a Home quote.</small>
          <div style="margin-top:auto;width:100%"><button class="btn btn-accent-outline" data-type="home">Start Home Quote</button></div>
        </div>
      </div>
    </section>

    <!-- Main quote UI (hidden until product selected) -->
    <section class="card" id="quoteCard" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:12px">
        <div>
          <div class="section-title" id="flowTitle">— Quote</div>
          <div class="muted small" id="quoteNumber">Quote #: —</div>
        </div>

        <div id="topTabs" style="display:flex;flex-direction:column;align-items:flex-end">
          <div class="tabs" id="tabsContainer" role="tablist" aria-label="Quote tabs"></div>
          <div class="muted small" style="margin-top:8px" id="productNote">Product note</div>
        </div>
      </div>

      <div class="form-area" id="formArea">
        <!-- dynamic tab content injected here -->
      </div>

      <div class="nav-actions">
        <div class="nav-left">
          <button id="prevBtn" class="btn btn-ghost">← Back</button>
          <button id="nextBtn" class="btn btn-primary">Continue →</button>
          <button id="saveDraft" class="btn btn-ghost">Save Draft</button>
        </div>

        <div>
          <button id="generateBtn" class="btn btn-primary">Generate Quote</button>
          <button id="saveFinal" class="btn btn-accent-outline">Save Quote</button>
        </div>
      </div>

      <div class="summary-card card" id="summaryCard">
        <div class="section-title">Quote Summary & Actions</div>
        <div id="summaryContent" class="muted small">No quote generated yet.</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button id="issuePolicy" class="btn btn-primary">Issue Policy</button>
          <button id="downloadJson" class="btn btn-ghost">Download JSON</button>
        </div>
      </div>
    </section>

  </main>

  <script>
    /**************************
     * Minimal JS to power the UI
     * - pure HTML/CSS (no libs)
     * - placeholder tab content per user's request
     **************************/

    // Tab definitions (placeholder text)
    const AUTO_TABS = [
      { id: 'policy', label: 'Policy Information', placeholder: 'Collect rating state, policy form, agent number, garaging address, ZIP, effective date, current policy status.' },
      { id: 'driver', label: 'Driver Information', placeholder: 'Collect driver name, DOB, gender, marital status, DL#, state issued, occupation, education, driving history, relationship.' },
      { id: 'vehicle', label: 'Vehicle Information', placeholder: 'Collect VIN, year, make, model, vehicle use, annual mileage, ownership status, anti-theft, safety features.' },
      { id: 'coverage', label: 'Coverage Selection', placeholder: 'Select liability limits, UM/UIM, medical/PIP, comp/coll deductibles, optional coverages, rental/towing options.' },
      { id: 'discounts', label: 'Discounts', placeholder: 'Multi-car, homeowner, bundling, safe-driver, RightTrack, defensive driving, anti-theft, autopay, paperless.' },
      { id: 'underwriting', label: 'Underwriting', placeholder: 'Questions: suspended licenses, DUI/major violations, rideshare use, modifications, claims history.' },
      { id: 'review', label: 'Review', placeholder: 'Summary of all captured fields, required-field checks, show premium estimate (placeholder), Edit / Save Draft / Submit / Issue.' },
      { id: 'billing', label: 'Billing', placeholder: 'Payment plan, method, down payment, billing address, mortgagee / lienholder info.' },
      { id: 'issue', label: 'Issue', placeholder: 'Final checklist and Issue Policy / Bind coverage.' },
    ];

    const HOME_TABS = [
      { id: 'applicant', label: 'Applicant', placeholder: 'Insured name, DOB, marital status, phone, email, prior insurance (Yes/No).' },
      { id: 'dwelling', label: 'Dwelling Information', placeholder: 'Property address, year built, sqft, roof type & age, construction type, garage, stories.' },
      { id: 'costguide', label: 'Cost Guide Features', placeholder: 'Replacement-cost related details: kitchen quality, flooring, fireplace, pool, deck, garage type.' },
      { id: 'underwriting', label: 'Underwriting', placeholder: 'Pets, pool, business on premises, prior claims, system updates (roof/wiring/HVAC).' },
      { id: 'coverage', label: 'Coverage Selection', placeholder: 'Dwelling A, Other Structures B, Personal Property C, Loss of Use D, Liability E, Deductible.' },
      { id: 'summary', label: 'Summary', placeholder: 'Review coverages, discounts, premium estimate (placeholder). Edit / Save Draft / Submit.' },
      { id: 'orderreport', label: 'Order Report', placeholder: 'Order CLUE, credit & inspection reports; attach results.' },
      { id: 'billing', label: 'Billing', placeholder: 'Payment plan, method, mortgagee, autopay options.' },
      { id: 'issue', label: 'Issue', placeholder: 'Final bind checklist and Issue Policy.' },
    ];

    // App state
    let product = null; // 'auto' | 'home'
    let tabs = [];
    let currentIndex = 0;
    let quoteData = {}; // simple key/value storage for draft
    const DRAFT_PREFIX = 'lava_quote_'; // localStorage key prefix

    // Elements
    const selectCard = document.getElementById('selectProductCard');
    const quoteCard = document.getElementById('quoteCard');
    const tabsContainer = document.getElementById('tabsContainer');
    const formArea = document.getElementById('formArea');
    const flowTitle = document.getElementById('flowTitle');
    const quoteNumberEl = document.getElementById('quoteNumber');
    const productNote = document.getElementById('productNote');
    const summaryCard = document.getElementById('summaryCard');
    const summaryContent = document.getElementById('summaryContent');

    // Start buttons on selection card
    document.querySelectorAll('#selectProductCard button[data-type]').forEach(btn=>{
      btn.addEventListener('click', ()=> beginQuote(btn.dataset.type));
    });

    // Back to dashboard (demo: just reload to start selection)
    document.getElementById('backToDash').addEventListener('click', ()=> {
      // in a real app, this would go to dashboard. For demo, reload and show selection.
      location.href = 'dashboard.html'; // keep behavior; user can change
    });

    // Navigation buttons
    document.getElementById('prevBtn').addEventListener('click', ()=>{
      if(currentIndex>0) { currentIndex--; renderTab(); }
    });
    document.getElementById('nextBtn').addEventListener('click', ()=>{
      if(currentIndex < tabs.length - 1) { currentIndex++; renderTab(); }
    });
    document.getElementById('saveDraft').addEventListener('click', ()=> {
      saveDraft();
      alert('Draft saved locally (browser localStorage).');
    });
    document.getElementById('generateBtn').addEventListener('click', ()=> {
      // placeholder generate action: show summary and a mock premium
      generateMockEstimate();
    });
    document.getElementById('saveFinal').addEventListener('click', ()=> {
      saveFinalQuote();
    });

    document.getElementById('issuePolicy').addEventListener('click', ()=> {
      alert('Issue Policy clicked — in a real system this would bind coverage.');
    });

    document.getElementById('downloadJson').addEventListener('click', ()=> {
      downloadJSON();
    });

    // Start the quote flow after selection
    function beginQuote(type) {
      product = (type === 'home') ? 'home' : 'auto';
      tabs = (product === 'home') ? HOME_TABS : AUTO_TABS;
      currentIndex = 0;
      quoteData = loadDraft() || {};
      // UI
      selectCard.style.display = 'none';
      quoteCard.style.display = 'block';
      flowTitle.textContent = (product === 'home' ? 'Home' : 'Auto') + ' Quote';
      quoteNumberEl.textContent = 'Quote #: ' + (quoteData.quoteNumber || generateQuoteNumber());
      productNote.textContent = product === 'home' ? 'Home flow: Applicant → Dwelling → Cost Guide → ...' : 'Auto flow: Policy → Driver → Vehicle → ...';
      buildTabs();
      renderTab();
      window.scrollTo({top:0,behavior:'smooth'});
    }

    // Create a simple quote number
    function generateQuoteNumber(){
      if(!quoteData.quoteNumber) quoteData.quoteNumber = Date.now().toString().slice(-8);
      return quoteData.quoteNumber;
    }

    // Build tab buttons
    function buildTabs(){
      tabsContainer.innerHTML = '';
      tabs.forEach((t, idx)=>{
        const b = document.createElement('button');
        b.className = 'tab-btn' + (idx===0 ? ' active' : '');
        b.textContent = t.label;
        b.type = 'button';
        b.dataset.index = idx;
        b.addEventListener('click', ()=> { currentIndex = idx; renderTab(); });
        tabsContainer.appendChild(b);
      });
    }

    // Render current tab content (placeholder)
    function renderTab(){
      // highlight tab buttons
      Array.from(tabsContainer.children).forEach((btn, i)=> btn.classList.toggle('active', i === currentIndex));
      const t = tabs[currentIndex];
      // inject placeholder content for this tab
      formArea.innerHTML = `
        <div class="section-title">${t.label}</div>
        <div class="placeholder">
          ${t.placeholder}
          <small> → Replace this placeholder with real form fields (inputs/selects) when ready.</small>
        </div>
      `;

      // show/hide generate/save buttons depending on tab
      const generateBtn = document.getElementById('generateBtn');
      const saveFinal = document.getElementById('saveFinal');
      if(product === 'auto') {
        generateBtn.style.display = (t.id === 'review') ? 'inline-block' : 'none';
      } else {
        generateBtn.style.display = (t.id === 'summary') ? 'inline-block' : 'none';
      }
      // Save final only on issue tab
      saveFinal.style.display = (t.id === 'issue') ? 'inline-block' : 'none';

      // prev/next visibility
      document.getElementById('prevBtn').style.display = currentIndex === 0 ? 'none' : 'inline-block';
      document.getElementById('nextBtn').style.display = currentIndex === tabs.length - 1 ? 'none' : 'inline-block';

      // hide summary panel until generate
      summaryCard.style.display = 'none';
    }

    // Minimal localStorage helpers
    function draftKey(){ return DRAFT_PREFIX + (product || 'none'); }
    function saveDraft(){
      // Currently placeholder-only: store quote number and timestamp
      quoteData.quoteNumber = quoteData.quoteNumber || generateQuoteNumber();
      quoteData.lastSaved = new Date().toISOString();
      localStorage.setItem(draftKey(), JSON.stringify(quoteData));
    }
    function loadDraft(){
      try {
        const raw = localStorage.getItem(draftKey());
        return raw ? JSON.parse(raw) : {};
      } catch(e){ return {}; }
    }
    function saveFinalQuote(){
      quoteData.quoteNumber = quoteData.quoteNumber || generateQuoteNumber();
      quoteData.product = product;
      quoteData.savedAt = new Date().toISOString();
      // Save into quotes array
      const arrRaw = localStorage.getItem('lava_quotes') || '[]';
      const arr = JSON.parse(arrRaw);
      arr.unshift(quoteData);
      localStorage.setItem('lava_quotes', JSON.stringify(arr));
      // clear draft
      localStorage.removeItem(draftKey());
      alert('Final quote saved locally. Quote #: ' + quoteData.quoteNumber);
      // show summary card with simple info
      summaryContent.innerHTML = `<div><strong>Quote #${quoteData.quoteNumber}</strong> — Product: ${product.toUpperCase()} — Saved: ${quoteData.savedAt}</div>`;
      summaryCard.style.display = 'block';
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    // Generate a mock estimate (placeholder)
    function generateMockEstimate(){
      // Create a fake premium value
      const base = (product === 'auto') ? 650 : 1200;
      // random-ish to vary per session
      const variability = Math.floor(Math.random()*300);
      const estimate = base + variability;
      // Show in placeholder UI
      const box = document.createElement('div');
      box.className = 'quote-result';
      box.innerHTML = `
        <div><strong>Mock Estimate</strong></div>
        <div class="small">Estimated ${product === 'auto' ? '6-month' : 'annual'} premium (placeholder): <strong>$${estimate.toFixed(2)}</strong></div>
        <div class="muted small" style="margin-top:8px">This is a mock estimate for UI/testing. Replace with your rating engine to produce real premiums.</div>
      `;
      // Inject into form area (below placeholder)
      formArea.appendChild(box);

      // Populate quoteData with sample estimate and show summary card
      quoteData.estimated = estimate;
      quoteData.estimateAt = new Date().toISOString();
      summaryContent.innerHTML = `
        <div><strong>Quote #${quoteData.quoteNumber || generateQuoteNumber()}</strong></div>
        <div>Product: ${product.toUpperCase()}</div>
        <div>Estimated: $${estimate.toFixed(2)}</div>
        <div class="muted small" style="margin-top:6px">Saved in draft — use Save Quote to persist as final.</div>
      `;
      summaryCard.style.display = 'block';
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    // Download JSON of current quoteData
    function downloadJSON(){
      const data = JSON.stringify(quoteData || { note: 'empty' }, null, 2);
      const blob = new Blob([data], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'quote_' + (quoteData.quoteNumber || 'draft') + '.json';
      document.body.appendChild(a); a.click(); a.remove();
    }

    // Also allow user to start over via URL param: ?start=select will show selection screen
    // But by default we show selection screen
    (function init(){
      // Intentionally start at selection view — per your last instruction
      selectCard.style.display = 'block';
      quoteCard.style.display = 'none';
    })();

    // Expose functions for debugging (optional)
    window._debug = { beginQuote, buildTabs, renderTab, saveDraft, loadDraft, generateMockEstimate, saveFinalQuote };

  </script>
</body>
</html>

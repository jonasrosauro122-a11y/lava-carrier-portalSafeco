<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LAVA Safeco | Quote</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: "Poppins", sans-serif;
      background-color: #f4f7f6;
      padding-top: 70px;
    }
    .navbar-brand img { height: 40px; border-radius: 8px; }
    .tab-content {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }
    .nav-tabs .nav-link.active { background-color: #0d6efd; color: #fff !important; }
    .section-title { font-weight: 600; color: #0d6efd; margin-bottom: 10px; }
    .quote-box {
      border: 2px solid #0d6efd;
      padding: 15px;
      border-radius: 10px;
      background-color: #f8faff;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg bg-white shadow-sm fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center" href="dashboard.html">
        <img src="images/lava-safeco-logo.png" alt="LAVA Safeco Logo" class="me-2" />
        <span class="fw-bold text-primary">LAVA Safeco</span>
      </a>
      <h5 class="ms-auto me-3 fw-bold text-primary" id="quoteTypeDisplay">Quote</h5>
      <a href="dashboard.html" class="btn btn-outline-primary me-3">Back to Dashboard</a>
    </div>
  </nav>

  <!-- Tabs Navigation -->
  <div class="container mt-4">
    <ul class="nav nav-tabs" id="quoteTabs"></ul>
    <div class="tab-content" id="tabContent"></div>
  </div>

  <!-- ==========================
       SCRIPT SECTION
  =========================== -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const params = new URLSearchParams(window.location.search);
      const quoteType = params.get("type")?.toLowerCase() || "auto";
      const quoteTabs = document.getElementById("quoteTabs");
      const tabContent = document.getElementById("tabContent");
      const quoteTypeDisplay = document.getElementById("quoteTypeDisplay");

      // Tab names
      const tabs = {
        auto: [
          "Policy Information",
          "Driver Information",
          "Vehicle Information",
          "Coverage Selection",
          "Discounts",
          "Underwriting",
          "Review",
          "Billing",
          "Issue",
        ],
        home: [
          "Applicant",
          "Dwelling Information",
          "Cost Guide Features",
          "Underwriting",
          "Coverage Selection",
          "Summary",
          "Order Report",
          "Billing",
          "Issue",
        ],
      };

      // Templates
      const templates = {
        "Policy Information": `
          <h5 class="section-title">Policy Information</h5>
          <div class="row g-3">
            <div class="col-md-3"><label>Rating State</label><input id="autoState" type="text" class="form-control" /></div>
            <div class="col-md-3"><label>Policy Form</label><input type="text" class="form-control" /></div>
            <div class="col-md-3"><label>Agent Number</label><input type="text" class="form-control" /></div>
            <div class="col-md-3"><label>Quote Date</label><input type="date" class="form-control" /></div>
          </div>
        `,
        "Driver Information": `
          <h5 class="section-title">Driver Information</h5>
          <div class="row g-3">
            <div class="col-md-4"><label>Driver Age</label><input id="driverAge" type="number" class="form-control" /></div>
            <div class="col-md-4"><label>Gender</label><select class="form-select"><option>Male</option><option>Female</option></select></div>
            <div class="col-md-4"><label>Years Licensed</label><input id="yearsLicensed" type="number" class="form-control" /></div>
          </div>
        `,
        "Vehicle Information": `
          <h5 class="section-title">Vehicle Information</h5>
          <div class="row g-3">
            <div class="col-md-3"><label>Year</label><input id="vehicleYear" type="number" class="form-control" /></div>
            <div class="col-md-3"><label>Make</label><input id="vehicleMake" type="text" class="form-control" /></div>
            <div class="col-md-3"><label>Model</label><input id="vehicleModel" type="text" class="form-control" /></div>
            <div class="col-md-3"><label>Annual Mileage</label><input id="annualMileage" type="number" class="form-control" /></div>
          </div>
        `,
        "Coverage Selection": `
          <h5 class="section-title">Coverage Selection</h5>
          <div class="row g-3">
            <div class="col-md-3"><label>Liability (BI/PD)</label><input type="text" class="form-control" placeholder="100/300/100" /></div>
            <div class="col-md-3"><label>Comp Deductible</label><input id="compDeductible" type="number" class="form-control" /></div>
            <div class="col-md-3"><label>Collision Deductible</label><input id="collDeductible" type="number" class="form-control" /></div>
          </div>
        `,
        Discounts: `
          <h5 class="section-title">Discounts</h5>
          <div class="row g-3">
            <div class="col-md-3"><label>Homeowner</label><select id="homeowner" class="form-select"><option>No</option><option>Yes</option></select></div>
            <div class="col-md-3"><label>Multi-car</label><select id="multiCar" class="form-select"><option>No</option><option>Yes</option></select></div>
          </div>
        `,
        Underwriting: `
          <h5 class="section-title">Underwriting</h5>
          <p>Answer underwriting questions truthfully to ensure accurate pricing.</p>
        `,
        Review: `
          <h5 class="section-title">Review</h5>
          <p>Review collected information and generate your auto quote.</p>
          <button class="btn btn-primary" onclick="generateAutoQuote()">Generate Quote</button>
          <div id="autoQuoteResult" class="quote-box mt-3"></div>
        `,
        Applicant: `
          <h5 class="section-title">Applicant Information</h5>
          <div class="row g-3">
            <div class="col-md-4"><label>Applicant Age</label><input id="applicantAge" type="number" class="form-control" /></div>
            <div class="col-md-4"><label>Credit Score</label><input id="creditScore" type="number" class="form-control" /></div>
          </div>
        `,
        "Dwelling Information": `
          <h5 class="section-title">Dwelling Information</h5>
          <div class="row g-3">
            <div class="col-md-4"><label>Year Built</label><input id="yearBuilt" type="number" class="form-control" /></div>
            <div class="col-md-4"><label>Square Footage</label><input id="sqft" type="number" class="form-control" /></div>
            <div class="col-md-4"><label>Roof Type</label><input id="roofType" type="text" class="form-control" /></div>
          </div>
        `,
        "Cost Guide Features": `
          <h5 class="section-title">Cost Guide Features</h5>
          <div class="row g-3">
            <div class="col-md-4"><label>Stories</label><input id="stories" type="number" class="form-control" /></div>
            <div class="col-md-4"><label>Garage Type</label><input type="text" class="form-control" /></div>
          </div>
        `,
        Summary: `
          <h5 class="section-title">Summary</h5>
          <p>Review home details and generate your quote.</p>
          <button class="btn btn-primary" onclick="generateHomeQuote()">Generate Home Quote</button>
          <div id="homeQuoteResult" class="quote-box mt-3"></div>
        `,
        Billing: `<h5 class="section-title">Billing Information</h5><p>Set up billing options here.</p>`,
        Issue: `<h5 class="section-title">Issue Policy</h5><p>Finalize and issue policy.</p>`,
        "Order Report": `<h5 class="section-title">Order Report</h5><p>Order property or claim reports here.</p>`
      };

      // Render Tabs
      const selectedTabs = quoteType === "home" ? tabs.home : tabs.auto;
      quoteTypeDisplay.textContent = quoteType.charAt(0).toUpperCase() + quoteType.slice(1) + " Quote";
      selectedTabs.forEach((tabName, index) => {
        quoteTabs.innerHTML += `
          <li class="nav-item">
            <a class="nav-link ${index === 0 ? "active" : ""}" data-bs-toggle="tab" href="#tab${index}">${tabName}</a>
          </li>`;
        tabContent.innerHTML += `
          <div class="tab-pane fade ${index === 0 ? "show active" : ""}" id="tab${index}">
            ${templates[tabName] || "<p>Form not defined.</p>"}
          </div>`;
      });
    });

    // ==========================
    // AUTO QUOTE CALCULATOR
    // ==========================
    function generateAutoQuote() {
      const age = parseInt(document.getElementById("driverAge").value) || 30;
      const year = parseInt(document.getElementById("vehicleYear").value) || 2020;
      const mileage = parseInt(document.getElementById("annualMileage").value) || 12000;
      const yearsLicensed = parseInt(document.getElementById("yearsLicensed").value) || 5;
      const homeowner = document.getElementById("homeowner")?.value === "Yes";
      const multiCar = document.getElementById("multiCar")?.value === "Yes";

      let baseRate = 700;
      baseRate += (2025 - year) * 5;
      if (age < 25) baseRate += 150;
      if (mileage > 15000) baseRate += 100;
      if (yearsLicensed > 10) baseRate -= 50;
      if (homeowner) baseRate -= 75;
      if (multiCar) baseRate -= 100;

      document.getElementById("autoQuoteResult").innerHTML = `
        <h6>Estimated Auto Premium:</h6>
        <p><strong>$${baseRate.toFixed(2)}</strong> / 6-month policy</p>
        <small>Includes multi-factor adjustments based on age, vehicle year, and discounts.</small>`;
    }

    // ==========================
    // HOME QUOTE CALCULATOR
    // ==========================
    function generateHomeQuote() {
      const yearBuilt = parseInt(document.getElementById("yearBuilt").value) || 2000;
      const sqft = parseInt(document.getElementById("sqft").value) || 1500;
      const creditScore = parseInt(document.getElementById("creditScore").value) || 700;
      const stories = parseInt(document.getElementById("stories").value) || 1;

      let baseRate = 800;
      baseRate += (2025 - yearBuilt) * 2;
      baseRate += (sqft / 1000) * 50;
      if (creditScore > 750) baseRate -= 75;
      if (stories > 1) baseRate += 40;

      document.getElementById("homeQuoteResult").innerHTML = `
        <h6>Estimated Home Premium:</h6>
        <p><strong>$${baseRate.toFixed(2)}</strong> / annual policy</p>
        <small>Based on dwelling size, age, and credit rating.</small>`;
    }
  </script>
</body>
</html>
